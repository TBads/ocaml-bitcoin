OASISFormat:		0.3
Name:			OCaml-bitcoin
Version:		1.1
Synopsis:		Library offering an OCaml interface to the official Bitcoin client API
Authors:		Dario Teixeira
License:		GPL-2.0
BuildTools:		ocamlbuild, ocamldoc
Plugins:		META (0.3), DevFiles (0.3)

Flag "ocsigen"
  Description:		Build auxiliary library "bitcoin_ocsigen" (implements an HTTP client using Ocsigenserver's Ocsigen_http_client)
  Default:		true

Flag "ocamlnet"
  Description:		Build auxiliary library "bitcoin_ocamlnet" (implements an HTTP client using Ocamlnet's Netclient)
  Default:		true

Library "bitcoin"
  Path:			src
  Modules:		Bitcoin
  BuildDepends:		netstring, yojson

Library "bitcoin_ocsigen"
  Build$:		flag(ocsigen)
  Install$:		flag(ocsigen)
  Path:			src
  Modules:		Bitcoin_ocsigen
  BuildDepends:		threads, lwt, ocsigenserver, bitcoin
  FindlibParent:	bitcoin
  FindlibName:		ocsigen

Library "bitcoin_ocamlnet"
  Build$:		flag(ocamlnet)
  Install$:		flag(ocamlnet)
  Path:			src
  Modules:		Bitcoin_ocamlnet
  BuildDepends:		netclient, bitcoin
  FindlibParent:	bitcoin
  FindlibName:		ocamlnet

Document "bitcoin-full-api"
  Build$:		flag(ocamlnet) && flag(ocsigen)
  Title:		API reference for OCaml-bitcoin
  Type:			ocamlbuild (0.3)
  Install:		true
  InstallDir:		$docdir
  BuildTools:		ocamldoc
  XOCamlbuildPath:	./
  XOCamlbuildLibraries:	bitcoin, bitcoin.ocsigen, bitcoin.ocamlnet

Document "bitcoin-ocamlnet-api"
  Build$:		flag(ocamlnet) && !flag(ocsigen)
  Title:		API reference for OCaml-bitcoin
  Type:			ocamlbuild (0.3)
  Install:		true
  InstallDir:		$docdir
  BuildTools:		ocamldoc
  XOCamlbuildPath:	./
  XOCamlbuildLibraries:	bitcoin, bitcoin.ocamlnet

Document "bitcoin-ocsigen-api"
  Build$:		!flag(ocamlnet) && flag(ocsigen)
  Title:		API reference for OCaml-bitcoin
  Type:			ocamlbuild (0.3)
  Install:		true
  InstallDir:		$docdir
  BuildTools:		ocamldoc
  XOCamlbuildPath:	./
  XOCamlbuildLibraries:	bitcoin, bitcoin.ocsigen

Document "bitcoin-api"
  Build$:		!flag(ocamlnet) && !flag(ocsigen)
  Title:		API reference for OCaml-bitcoin
  Type:			ocamlbuild (0.3)
  Install:		true
  InstallDir:		$docdir
  BuildTools:		ocamldoc
  XOCamlbuildPath:	./
  XOCamlbuildLibraries:	bitcoin

Executable test
  Build$:		flag(tests) && flag(ocamlnet)
  Path:			test
  MainIs:		test.ml
  Install:		false
  BuildDepends:		oUnit (>= 1.1.0), bitcoin.ocamlnet
  CompiledObject:	best
  
Test main
  Run$:			flag(tests) && flag(ocamlnet)
  Command:		$test

